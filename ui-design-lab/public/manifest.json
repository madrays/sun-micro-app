{
  "generatedAt": "2026-02-21T23:36:30+08:00",
  "generatedAtUtc": "2026-02-21T15:36:30.169Z",
  "workspaceRoot": "/Volumes/Madrays/sundev",
  "gridStandard": {
    "unit": 76,
    "gap": 22
  },
  "apps": [
    {
      "id": "holiday-countdown-app",
      "path": "holiday-countdown-app",
      "componentsConfig": "holiday-countdown-app/config/components.config.js",
      "widgets": [
        {
          "id": "holiday-countdown-widget",
          "sizes": [
            "1x1",
            "1x2",
            "2x1",
            "2x2",
            "2x4"
          ],
          "componentPath": "holiday-countdown-app/src/components/holiday-countdown-widget.js",
          "baseStyle": "\n      :host { display:block; width:100%; height:100%; overflow:hidden; }\n      * { box-sizing:border-box; }\n      .wrap {\n        position: relative;\n        width:100%;\n        height:100%;\n        display:grid;\n        container-type: size;\n        color: #111111;\n        font-family: \"STKaiti\", \"KaiTi\", \"Noto Serif SC\", serif;\n        background: transparent;\n        overflow:hidden;\n        align-items: center;\n        justify-items: center;\n      }\n      /* Default layout structure (can be overridden by specific sizes) */\n      .info {\n        grid-area: info;\n        min-width: 0;\n        max-width: 100%;\n        height: 100%;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n      }\n      .art-box {\n        grid-area: art;\n        width: 100%;\n        height: 100%;\n        min-width: 0;\n        min-height: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        overflow: hidden;\n      }\n      .content {\n        width: 100%;\n        min-width: 0;\n        max-width: 100%;\n        height: 100%;\n        overflow: hidden;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n      }\n      .sub { margin: 0 0 2%; font-size: var(--fs-sub, 3cqw); color: rgba(17,17,17,.68); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.2; }\n      .title { margin: 0; font-size: var(--fs-title, 6cqw); line-height: 1.1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: 700; text-align: center; }\n      .num-line { margin: 0; white-space: nowrap; display:flex; align-items:baseline; justify-content: center; min-width:0; overflow:hidden; line-height: 1; }\n      .num { font-size: var(--fs-num, 14cqw); font-weight: 700; letter-spacing: -0.02em; }\n      .unit { font-size: var(--fs-unit, 4cqw); margin-left: 0.2em; }\n      .date { margin-top: 2%; font-size: var(--fs-date, 3cqw); color: rgba(17,17,17,.68); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.2; }\n      \n      .hide-sub .sub { display:none !important; }\n      .hide-date .date { display:none !important; }\n      \n      .art { width: 100%; height: 100%; min-height: 0; opacity: 1; display:block; }\n      .art-img { width:100%; height:100%; display:block; object-fit: contain; object-position: center center; }\n      .state { width:100%; height:100%; display:flex; align-items:center; justify-content:center; font-size: 13px; color:rgba(17,17,17,.68); }\n    ",
          "sizeStyles": {
            "1x1": "\n        .wrap {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 8%;\n          gap: 4%;\n        }\n        .title { font-size: 24cqmin; font-weight: 700; text-align: center; }\n        .num-line { display: flex; align-items: baseline; justify-content: center; }\n        .num { font-size: 30cqmin; font-weight: 800; }\n        .unit { font-size: 20cqmin; font-weight: 600; margin-left: 0.1em; }\n      ",
            "1x2": "\n        .wrap {\n          display: grid;\n          grid-template-columns: 30% 30% 30%;\n          column-gap: 5%;\n          padding: 0 5%;\n          height: 100%;\n          align-items: center;\n          justify-items: center;\n        }\n        .title { font-size: 20cqh; font-weight: 700; text-align: center; }\n        .num-line { display: flex; align-items: baseline; justify-content: center; }\n        .num { font-size: 26cqh; font-weight: 800; }\n        .unit { font-size: 16cqh; font-weight: 600; margin-left: 0.1em; }\n        .art-box { grid-area: auto; width: 100%; height: 80%; display: flex; align-items: center; justify-content: center; }\n        .art-img { width: 100%; height: 100%; object-fit: contain; }\n      ",
            "2x1": "\n        .wrap {\n          display: grid;\n          grid-template-rows: 30% 30% 30%;\n          row-gap: 5%;\n          padding: 5% 0;\n          width: 100%;\n          align-items: center;\n          justify-items: center;\n        }\n        .title { font-size: 20cqw; font-weight: 700; text-align: center; }\n        .num-line { display: flex; align-items: baseline; justify-content: center; }\n        .num { font-size: 26cqw; font-weight: 800; }\n        .unit { font-size: 16cqw; font-weight: 600; margin-left: 0.1em; }\n        .art-box { grid-area: auto; width: 80%; height: 100%; display: flex; align-items: center; justify-content: center; }\n        .art-img { width: 100%; height: 100%; object-fit: contain; }\n      ",
            "2x2": "\n        .wrap {\n          display: grid;\n          grid-template-areas:\n            \"sub sub\"\n            \"info art\";\n          grid-template-rows: 22% 78%;\n          grid-template-columns: 45% 55%;\n          padding: 5%;\n          gap: 2%;\n        }\n        .sub-row { grid-area: sub; display: flex; align-items: center; justify-content: center; font-size: 10cqw; font-weight: 700; }\n        .info { grid-area: info; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6%; }\n        .title { font-size: 9cqw; font-weight: 700; }\n        .num-line { display: flex; align-items: baseline; justify-content: center; }\n        .num { font-size: 16cqw; font-weight: 800; }\n        .unit { font-size: 9cqw; font-weight: 600; margin-left: 0.05em; }\n        .date { font-size: 8cqw; opacity: 0.85; }\n        .art-box { grid-area: art; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }\n        .art-img { width: 100%; height: 100%; object-fit: contain; }\n      ",
            "2x4": "\n        .wrap {\n          display: grid;\n          grid-template-areas: \"info art\";\n          grid-template-columns: 35% 65%;\n          padding: 4%;\n          gap: 2%;\n          align-items: center;\n        }\n        .info { display: flex; align-items: center; justify-content: center; height: 100%; }\n        .content { display: flex; flex-direction: column; align-items: center; gap: 4%; text-align: center; }\n        .sub { font-size: 3.5cqw; opacity: 0.85; }\n        .title { font-size: 9cqw; font-weight: 700; }\n        .num-line { display: flex; align-items: baseline; }\n        .num { font-size: 16cqw; font-weight: 800; }\n        .unit { font-size: 10cqw; font-weight: 600; margin-left: 0.05em; }\n        .date { font-size: 3.5cqw; opacity: 0.8; }\n        .art-box { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }\n        .art-img { width: 100%; height: 100%; object-fit: contain; }\n      "
          },
          "showArtSizes": [
            "1x2",
            "2x1",
            "2x2",
            "2x4"
          ],
          "hideSubSizes": [
            "1x1",
            "1x2",
            "2x1"
          ],
          "hideDateSizes": [
            "1x1",
            "1x2",
            "2x1"
          ],
          "sourcePreview": "import { html } from 'lit';\nimport { SunPanelWidgetElement } from '@sun-panel/micro-app';\nimport {\n  daysBetween,\n  formatHolidayDate,\n  normalizeHolidayName,\n  getNextHoliday\n} from '../utils/holiday-calendar.js';\nimport { getHolidayArtDataUri } from '../utils/holiday-art.js';\n\nfunction dateKeyOf(date = new Date()) {\n  const y = date.getFullYear();\n  const m = String(date.getMonth() + 1).padStart(2, '0');\n  const d = String(date.getDate()).padStart(2, '0');\n  return `${y}-${m}-${d}`;\n}\n\nexport class HolidayCountdownWidget extends SunPanelWidgetElement {\n  static properties = {\n    snapshot: { type: Object },\n    loading: { type: Boolean },\n    error: { type: String },\n    config: { type: Object }\n  };\n\n  constructor() {\n    super();\n    this.snapshot = null;\n    this.loading = true;\n    this.error = '';\n    this.config = {};\n    this._timer = null;\n    this._computePromise = null;\n    this._lastComputeAt = 0;\n  }\n\n  async onInitialized() {\n    this.loadConfig();\n    await this.compute({ force: true });\n    this.startTimer();\n  }\n\n  async onWidgetInfoChanged(newWidgetInfo, oldWidgetInfo) {\n    this.requestUpdate();\n    const newConfig = newWidgetInfo?.config || {};\n    const oldConfig = oldWidgetInfo?.config || {};\n    this.config = newConfig;\n    if (JSON.stringify(newConfig) !== JSON.stringify(oldConfig)) {\n      await this.compute({ force: true });\n    }\n  }\n\n  onDisconnected() {\n    if (this._timer) {\n      clearInterval(this._timer);\n      this._timer = null;\n    }\n  }\n\n  loadConfig() {\n    this.config = this.spCtx.widgetInfo?.config || {};\n  }\n\n  startTimer() {\n    if (this._timer) clearInterval(this._timer);\n    this._timer = setInterval(() => this.compute({ force: true }), 60 * 60 * 1000);\n  }\n\n  async _computeCore() {\n    this.loading = true;\n    this.error = '';\n    try {\n      const now = new Date();\n      const nowDateKey = dateKeyOf(now);\n\n      // ç›´æ¥æœ¬åœ°è®¡ç®—ä¸‹ä¸€ä¸ªèŠ‚æ—¥ï¼Œä¸ä¾èµ– API\n      const nextHoliday = getNextHoliday(now);\n      if (!nextHoliday) {\n        throw new Error('æœªè·å–åˆ°ä¸‹ä¸€ä¸ªèŠ‚å‡æ—¥');\n      }\n\n      const daysLeft = daysBetween(now, nextHoliday.date);\n      const next = {\n        name: nextHoliday.name,\n        normalizedName: nextHoliday.name,\n        dateObj: nextHoliday.date,\n        date: formatHolidayDate(nextHoliday.date),\n        daysLeft,\n        isToday: daysLeft === 0\n      };\n\n      this.snapshot = {\n        today: nowDateKey,\n        next\n      };\n    } catch (e) {\n      this.error = e?.message || 'èŠ‚å‡æ—¥è®¡ç®—å¤±è´¥';\n      this.snapshot = null;\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async compute({ force = false } = {}) {\n    const now = Date.now();\n    if (!force && now - this._lastComputeAt < 10 * 1000) return;\n    if (this._computePromise) return this._computePromise;\n\n    this._lastComputeAt = now;\n    this._computePromise = this._computeCore();\n    try {\n      await this._computePromise;\n    } finally {\n      this._computePromise = null;\n    }\n  }\n\n  get nextHoliday() {\n    return this.snapshot?.next || null;\n  }\n\n  get displayHolidayName() {\n    const h = this.nextHoliday;\n    if (!h) return '';\n    return normalizeHolidayName(h.name);\n  }\n\n  get textColor() {\n    return this.config?.textMode === 'dark' ? '#0f172a' : '#ffffff';\n  }\n\n  get subTextColor() {\n    return this.config?.textMode === 'dark' ? 'rgba(15,23,42,.72)' : 'rgba(255,255,255,.84)';\n  }\n\n  get baseStyle() {\n    return `\n      :host { display:block; width:100%; height:100%; overflow:hidden; }\n      * { box-sizing:border-box; }\n      .wrap {\n        position: relative;\n        width:100%;\n        height:100%;\n        display:grid;\n        container-type: size;\n        color: ${this.textColor};\n        font-family: \"STKaiti\", \"KaiTi\", \"Noto Serif SC\", serif;\n        background: transparent;\n        overflow:hidden;\n        align-items: center;\n        justify-items: center;\n      }\n      /* Default layout structure (can be overridden by specific sizes) */\n      .info {\n        grid-area: info;\n        min-width: 0;\n        max-width: 100%;\n        height: 100%;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n      }\n      .art-box {\n        grid-area: art;\n        width: 100%;\n        height: 100%;\n        min-width: 0;\n        min-height: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        overflow: hidden;\n      }\n      .content {\n        width: 100%;\n        min-width: 0;\n        max-width: 100%;\n        height: 100%;\n        overflow: hidden;"
        }
      ]
    },
    {
      "id": "pixel-pet-app",
      "path": "pixel-pet-app",
      "componentsConfig": "pixel-pet-app/config/components.config.js",
      "widgets": [
        {
          "id": "pixel-pet-widget",
          "sizes": [
            "2x2",
            "2x4"
          ],
          "componentPath": "pixel-pet-app/src/components/pixel-pet-widget.js",
          "baseStyle": "\n      :host { display:block; width:100%; height:100%; }\n      * { box-sizing:border-box; }\n      @keyframes breathe { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-2px)} }\n      @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }\n      @keyframes fadeUp { 0%{opacity:1;transform:translateY(0)} 100%{opacity:0;transform:translateY(-10px)} }\n      @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-2px)} 75%{transform:translateX(2px)} }\n      .wrap { position:relative; }\n      .wrap:hover .float-btns { opacity:1; pointer-events:auto; }\n      .pet-svg { cursor:pointer; transition:transform .15s; }\n      .pet-svg:hover { transform:scale(1.05); }\n      .pet-svg svg { width:100%; height:100%; animation: initial; }\n      .bubble { position:absolute; background:#fff; padding:5px 12px; border-radius:12px; font-size:12px; box-shadow:0 2px 8px rgba(0,0,0,.15); white-space:nowrap; z-index:20; opacity:initial; transition:opacity .3s; pointer-events:none; }\n      .change { position:absolute; font-size:12px; font-weight:600; animation:fadeUp 1.5s forwards; pointer-events:none; z-index:15; }\n      .bar { height:5px; background:rgba(0,0,0,.08); border-radius:3px; overflow:hidden; cursor:pointer; }\n      .bar-fill { height:100%; border-radius:3px; transition:width .3s; }\n      .bar-wrap { position:relative; }\n      .bar-wrap:hover .bar-tip { opacity:1; }\n      .bar-tip { position:absolute; top:-22px; left:50%; transform:translateX(-50%); background:#333; color:#fff; padding:2px 6px; border-radius:4px; font-size:9px; white-space:nowrap; opacity:0; transition:opacity .2s; pointer-events:none; z-index:100; }\n      .float-btns { position:absolute; display:flex; gap:6px; opacity:0; pointer-events:none; transition:opacity .2s; z-index:10; }\n      .btn { position:relative; width:30px; height:30px; border:none; background:rgba(255,255,255,.95); border-radius:50%; cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,.12); font-size:13px; display:flex; align-items:center; justify-content:center; transition:all .15s; }\n      .btn:hover { transform:scale(1.1); background:#fff; }\n      .btn:active { transform:scale(0.95); }\n      .btn:hover::after { content:attr(data-tip); position:absolute; bottom:100%; left:50%; transform:translateX(-50%); background:#333; color:#fff; padding:3px 8px; border-radius:4px; font-size:10px; white-space:nowrap; margin-bottom:4px; }\n      .name-tag { display:inline-block; padding:2px 8px; font-size:10px; font-weight:600; }\n      .tag-0 { background:#fff9e6; color:#d97706; border-radius:3px 8px 8px 3px; border:1.5px solid #fbbf24; border-left:3px solid #f59e0b; }\n      .tag-1 { background:#e0f2fe; color:#0284c7; border-radius:10px; border:1.5px solid #7dd3fc; }\n      .tag-2 { background:#fce7f3; color:#db2777; border-radius:0 8px 0 8px; border:1.5px solid #f9a8d4; }\n      .tag-3 { background:#ecfccb; color:#65a30d; border-radius:8px 0 8px 0; border:1.5px solid #bef264; }\n      .hunger .bar-fill { background:linear-gradient(90deg,#fbbf24,#f59e0b); }\n      .happy .bar-fill { background:linear-gradient(90deg,#a78bfa,#8b5cf6); }\n      .love .bar-fill { background:linear-gradient(90deg,#fb7185,#ef4444); }\n      .health .bar-fill { background:linear-gradient(90deg,#34d399,#10b981); }\n    ",
          "sizeStyles": {},
          "showArtSizes": null,
          "hideSubSizes": null,
          "hideDateSizes": null,
          "sourcePreview": "import { html } from 'lit';\nimport { SunPanelWidgetElement } from '@sun-panel/micro-app';\nimport { PetState } from '../utils/pet-state.js';\nimport { generatePetSvg } from '../utils/pet-sprites.js';\nimport { getDialogue } from '../utils/pet-data.js';\n\nexport class PixelPetWidget extends SunPanelWidgetElement {\n  static properties = {\n    state: { type: Object },\n    action: { type: String },\n    frame: { type: Number },\n    dialogue: { type: String },\n    showBubble: { type: Boolean },\n    config: { type: Object },\n    lastChange: { type: String },\n    changeColor: { type: String },\n    hovering: { type: Boolean },\n    petX: { type: Number },\n    petDir: { type: Number },\n    inScene: { type: Boolean }\n  };\n\n  constructor() {\n    super();\n    this.state = PetState.create();\n    this.action = 'idle';\n    this.frame = 0;\n    this.dialogue = '';\n    this.showBubble = false;\n    this.config = {};\n    this.lastChange = '';\n    this.changeColor = '#22c55e';\n    this.hovering = false;\n    this.petX = 80;\n    this.petDir = 1;\n    this.inScene = false;\n    this.sceneIdx = Math.floor(Math.random() * 4);\n  }\n\n  get petType() { return this.config.petType || 'cat'; }\n  get petName() { return this.config.petName || 'å® ç‰©'; }\n  get personality() { return this.config.personality || 'cheerful'; }\n  get tagStyle() { return this.config.tagStyle || 0; }\n  get petStyle() { return this.config.petStyle || 'cute'; }\n\n  get stateKey() {\n    return `state-${this.spCtx.widgetInfo?.id || 'default'}`;\n  }\n\n  async onInitialized() {\n    this.makeTransparent();\n    this.config = this.spCtx.widgetInfo?.config || {};\n    try {\n      const saved = await this.spCtx.api.dataNode.app.getByKey('pet-state', this.stateKey);\n      console.log('[pet] loaded:', this.stateKey, saved);\n      if (saved && saved.hunger !== undefined) this.state = PetState.decay(saved);\n    } catch (e) { console.log('[pet] load error:', e); }\n    this._timer = setInterval(() => {\n      this.state = PetState.decay(this.state);\n      this.maybeSpeak();\n      this.requestUpdate();\n    }, 30000);\n    this._animTimer = setInterval(() => {\n      this.frame = (this.frame + 1) % 24;\n      // å® ç‰©è‡ªç”±ç§»åŠ¨ï¼ˆ2x4æ¨¡å¼ä¸‹å¯ä»¥è·‘åˆ°å³è¾¹åœºæ™¯ï¼‰\n      if (this.action === 'idle' && Math.random() < 0.25) {\n        this.petX += this.petDir * 10;\n        if (this.petX > 300) { this.petX = 300; this.petDir = -1; }\n        if (this.petX < 20) { this.petX = 20; this.petDir = 1; }\n        this.inScene = this.petX > 160;\n      }\n      this.requestUpdate();\n    }, 250);\n    setTimeout(() => this.speak(PetState.getMood(this.state)), 2000);\n  }\n\n  onWidgetInfoChanged(newInfo) {\n    this.config = newInfo?.config || {};\n    this.requestUpdate();\n  }\n\n  makeTransparent() {\n    let el = this.parentElement;\n    while (el) {\n      if (el.classList?.contains('item-card-content') || el.classList?.contains('widget-container')) {\n        el.style.background = 'transparent';\n        el.style.backgroundColor = 'transparent';\n      }\n      el = el.parentElement;\n    }\n  }\n\n  onDisconnected() {\n    clearInterval(this._timer);\n    clearInterval(this._animTimer);\n  }\n\n  updated() { this.makeTransparent(); }\n\n  async save() {\n    try {\n      const result = await this.spCtx.api.dataNode.app.setByKey('pet-state', this.stateKey, this.state);\n      console.log('[pet] save result:', result, 'key:', this.stateKey, 'state:', this.state);\n    } catch (e) { console.log('[pet] save error:', e, e?.code, e?.message); }\n  }\n\n  speak(state) {\n    this.dialogue = getDialogue(state, this.personality);\n    this.showBubble = true;\n    clearTimeout(this._bubbleTimer);\n    this._bubbleTimer = setTimeout(() => { this.showBubble = false; this.requestUpdate(); }, 3000);\n  }\n\n  maybeSpeak() {\n    if (Math.random() < 0.4) this.speak(PetState.getMood(this.state));\n  }\n\n  showChange(text, ok = true) {\n    this.lastChange = text;\n    this.changeColor = ok ? '#22c55e' : '#ef4444';\n    clearTimeout(this._changeTimer);\n    this._changeTimer = setTimeout(() => { this.lastChange = ''; this.requestUpdate(); }, 1500);\n  }\n\n  async doAction(actionFn, okAction, okState) {\n    const { state, result, msg } = actionFn.call(PetState, this.state);\n    this.state = state;\n    if (result === 'ok') {\n      this.action = okAction;\n      this.speak(okState);\n      this.showChange(msg, true);\n    } else {\n      this.action = 'sad';\n      this.speak('refuse');\n      this.showChange(msg, false);\n    }\n    await this.save();\n    setTimeout(() => { this.action = 'idle'; this.requestUpdate(); }, 1500);\n  }\n\n  doFeed() { this.doAction(PetState.feed, 'eat', 'feed'); }\n  doPlay() { this.doAction(PetState.play, 'jump', 'play'); }\n  doPet() { this.doAction(PetState.pet, 'happy', 'pet'); }\n  doHeal() { this.doAction(PetState.heal, 'happy', 'happy'); }\n\n  get petSvg() {\n    const mood = this.action !== 'idle' ? this.action : PetState.getMood(this.state);\n    return generatePetSvg(this.petType, mood, this.frame, this.petStyle);\n  }\n\n  getMoodText(mood) {\n    const texts = { happy: 'ğŸ˜Š å¿ƒæƒ…æ„‰å¿«', idle: 'ğŸ˜ çŠ¶æ€ä¸€èˆ¬', sad: 'ğŸ˜¢ æœ‰ç‚¹éš¾è¿‡', hungry: 'ğŸ½ï¸ è‚šå­é¥¿äº†', sick: 'ğŸ¤’ èº«ä½“ä¸é€‚', sleep: 'ğŸ˜´ æ˜æ˜æ¬²ç¡' };\n    return texts[mood] || 'ğŸ˜ çŠ¶æ€ä¸€èˆ¬';\n  }\n\n  getMoodDesc(mood, s) {\n    if (mood === 'sick') return `å¥åº·å€¼è¿‡ä½ï¼Œéœ€è¦æ²»ç–—æ¢å¤ã€‚å½“å‰å¥åº·: ${s.health}`;\n    if (mood === 'hungry') return `é¥±é£Ÿåº¦ä¸è¶³ï¼Œå¿«å–‚ç‚¹ä¸œè¥¿å§ï¼å½“å‰é¥±é£Ÿ: ${s.hunger}`;\n    if (mood === 'happy') return `${this.petName}ç°åœ¨å¾ˆå¼€å¿ƒï¼Œç»§ç»­ä¿æŒäº’åŠ¨å§~`;\n    if (mood === 'sad') return `å¿ƒæƒ…ä¸å¤ªå¥½ï¼Œå¤šé™ªé™ª${this.petName}ç©è€å§`;\n    return `${this.petName}çŠ¶æ€è¿˜ä¸é”™ï¼Œè®°å¾—å®šæœŸäº’åŠ¨å“¦`;\n  }\n\n  get baseStyle() {\n    return `\n      :host { display:block; width:100%; height:100%; }\n      * { box-sizing:border-box; }\n      @keyframes breathe { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-2px)} }\n      @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }\n      @keyframes fadeUp { 0%{opacity:1;transform:translateY(0)} 100%{opacity:0;transform:translateY(-10px)} }\n      @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-2px)} 75%{transform:translateX(2px)} }\n      .wrap { position:relative; }\n      .wrap:hover .float-btns { opacity:1; pointer-events:auto; }\n      .pet-svg { cursor:pointer; transition:transform .15s; }\n      .pet-svg:hover { transform:scale(1.05); }\n      .pet-svg svg { width:100%; height:100%; animation: ${this.action==='jump'?'bounce .25s infinite':this.action==='sad'?'shake .3s':'breathe 2s ease-in-out infinite'}; }\n      .bubble { position:absolute; background:#fff; padding:5px 12px; border-radius:12px; font-size:12px; box-shadow:0 2px 8px rgba(0,0,0,.15); white-space:nowrap; z-index:20; opacity:${this.showBubble?1:0}; transition:opacity .3s; pointer-events:none; }\n      .change { position:absolute; font-size:12px; font-weight:600; animation:fadeUp 1.5s forwards; pointer-events:none; z-index:15; }\n      .bar { height:5px; background:rgba(0,0,0,.08); border-radius:3px; overflow:hidden; cursor:pointer; }\n      .bar-fill { height:100%; border-radius:3px; transition:width .3s; }"
        }
      ]
    },
    {
      "id": "qb-downloader-app",
      "path": "qb-downloader-app",
      "componentsConfig": "qb-downloader-app/config/components.config.js",
      "widgets": [
        {
          "id": "qb-widget",
          "sizes": [
            "1x1",
            "1x2",
            "2x1",
            "2x2",
            "2x4"
          ],
          "componentPath": "qb-downloader-app/src/components/qb-widget.js",
          "baseStyle": ":host{display:block;width:100%;height:100%;overflow:hidden}*{box-sizing:border-box;margin:0;padding:0}.w{width:100%;height:100%;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;color:initial;display:flex;flex-direction:column;overflow:hidden;min-width:0;min-height:0}.icon{display:inline-flex;align-items:center;justify-content:center;flex-shrink:0}.icon svg{width:100%;height:100%}.dl{color:initial}.up{color:initial}.seed{color:initial}.pause{color:initial}.total{color:initial}.ratio{color:initial}.disk{color:initial}.glass{background:initial;border-radius:4px}.val,.speed-val,.speed-num,.stat-val,.item-val,.metric-val{white-space:nowrap}",
          "sizeStyles": {},
          "showArtSizes": null,
          "hideSubSizes": null,
          "hideDateSizes": null,
          "sourcePreview": "import { html } from 'lit';\nimport { SunPanelWidgetElement } from '@sun-panel/micro-app';\nimport { formatSpeed, formatBytes, formatRatio, categorizeTorrents, ICONS } from '../utils/format.js';\n\nexport class QbWidget extends SunPanelWidgetElement {\n  static properties = {\n    data: { type: Object },\n    torrents: { type: Object },\n    loading: { type: Boolean },\n    error: { type: String },\n    config: { type: Object }\n  };\n\n  constructor() {\n    super();\n    this.data = null;\n    this.torrents = {};\n    this.loading = true;\n    this.error = '';\n    this.config = {};\n    this._timer = null;\n    this._rid = 0;\n  }\n\n  async onInitialized() {\n    this.config = this.spCtx.widgetInfo?.config || {};\n    await this.fetchData();\n    this.startRefresh();\n  }\n\n  onWidgetInfoChanged(newInfo) {\n    const newCfg = newInfo?.config;\n    if (newCfg && JSON.stringify(newCfg) !== JSON.stringify(this.config)) {\n      this.config = newCfg;\n      this.startRefresh();\n    }\n    this.requestUpdate();\n  }\n\n  startRefresh() {\n    if (this._timer) clearInterval(this._timer);\n    // æš‚æ—¶ç¦ç”¨è‡ªåŠ¨åˆ·æ–°ï¼Œç­‰ç™»å½•é—®é¢˜è§£å†³åå†å¯ç”¨\n    // const interval = (this.config?.refreshInterval || 5) * 1000;\n    // this._timer = setInterval(() => this.fetchData(), interval);\n  }\n\n  onDisconnected() { if (this._timer) clearInterval(this._timer); }\n\n  async login() {\n    try {\n      await this.spCtx.api.network.request({\n        targetUrl: '{{host}}/api/v2/auth/login',\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: 'username={{username}}&password={{password}}',\n        templateReplacements: [\n          { placeholder: '{{host}}', fields: ['targetUrl'], dataNode: 'config.host' },\n          { placeholder: '{{username}}', fields: ['body'], dataNode: 'config.username' },\n          { placeholder: '{{password}}', fields: ['body'], dataNode: 'config.password' }\n        ]\n      });\n      return true;\n    } catch { return false; }\n  }\n\n  async fetchData() {\n    try {\n      let res = await this.spCtx.api.network.request({\n        targetUrl: `{{host}}/api/v2/sync/maindata?rid=${this._rid}`,\n        method: 'GET',\n        templateReplacements: [{ placeholder: '{{host}}', fields: ['targetUrl'], dataNode: 'config.host' }]\n      });\n      // å¦‚æœè¿”å› Forbiddenï¼Œå°è¯•ç™»å½•åé‡è¯•\n      if (res?.status === 403 || res?.data === 'Forbidden') {\n        await this.login();\n        res = await this.spCtx.api.network.request({\n          targetUrl: `{{host}}/api/v2/sync/maindata?rid=${this._rid}`,\n          method: 'GET',\n          templateReplacements: [{ placeholder: '{{host}}', fields: ['targetUrl'], dataNode: 'config.host' }]\n        });\n      }\n      const d = res?.data || res;\n      if (d.rid) this._rid = d.rid;\n      if (d.full_update || !this.data) {\n        this.data = d.server_state || {};\n        this.torrents = d.torrents || {};\n      } else {\n        if (d.server_state) Object.assign(this.data, d.server_state);\n        if (d.torrents) Object.assign(this.torrents, d.torrents);\n        if (d.torrents_removed) d.torrents_removed.forEach(h => delete this.torrents[h]);\n      }\n      this.error = '';\n    } catch (e) {\n      this.error = String(e?.message || '').includes('not found') ? 'è¯·å…ˆé…ç½®è¿æ¥' : 'è¿æ¥å¤±è´¥';\n    } finally { this.loading = false; }\n  }\n\n  get colors() {\n    const light = this.config?.textMode !== 'dark';\n    return {\n      text: light ? '#fff' : '#1a1a2e',\n      sub: light ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.5)',\n      glass: light ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.05)',\n      dl: '#22c55e', up: '#3b82f6',\n      seed: '#f59e0b', pause: '#94a3b8', total: '#a855f7',\n      ratio: '#06b6d4', disk: '#ec4899'\n    };\n  }\n\n  icon(name, size = 16) {\n    return html`<span class=\"icon\" style=\"width:${size}px;height:${size}px\" .innerHTML=${ICONS[name] || ''}></span>`;\n  }\n\n  // æ ¹æ®æ–‡æœ¬é•¿åº¦åŠ¨æ€è®¡ç®—å­—å·\n  fs(text, base, min = 8) {\n    const len = String(text).length;\n    if (len <= 6) return base;\n    if (len <= 8) return Math.max(base * 0.85, min);\n    if (len <= 10) return Math.max(base * 0.7, min);\n    return Math.max(base * 0.6, min);\n  }\n\n  get baseStyle() {\n    const c = this.colors;\n    return `:host{display:block;width:100%;height:100%;overflow:hidden}*{box-sizing:border-box;margin:0;padding:0}.w{width:100%;height:100%;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;color:${c.text};display:flex;flex-direction:column;overflow:hidden;min-width:0;min-height:0}.icon{display:inline-flex;align-items:center;justify-content:center;flex-shrink:0}.icon svg{width:100%;height:100%}.dl{color:${c.dl}}.up{color:${c.up}}.seed{color:${c.seed}}.pause{color:${c.pause}}.total{color:${c.total}}.ratio{color:${c.ratio}}.disk{color:${c.disk}}.glass{background:${c.glass};border-radius:4px}.val,.speed-val,.speed-num,.stat-val,.item-val,.metric-val{white-space:nowrap}`;\n  }\n\n  render() {\n    const c = this.colors;\n    if (this.loading) return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;font-size:11px;color:${c.sub}}</style><div class=\"w\">åŠ è½½ä¸­...</div>`;\n    if (this.error) return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;font-size:11px;color:#f87171}</style><div class=\"w\">${this.error}</div>`;\n    const size = this.spCtx.widgetInfo?.gridSize;\n    if (size === '1x1') return this.render1x1();\n    if (size === '1x2') return this.render1x2();\n    if (size === '2x1') return this.render2x1();\n    if (size === '2x4') return this.render2x4();\n    return this.render2x2();\n  }\n\n  render1x1() {\n    const d = this.data, dl = formatSpeed(d.dl_info_speed), up = formatSpeed(d.up_info_speed);\n    return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;gap:8px;padding:6px}.row{display:flex;align-items:center;gap:4px}.val{font-weight:700;letter-spacing:-0.3px}</style>\n      <div class=\"w\">\n        <div class=\"row dl\">${this.icon('download',14)}<span class=\"val\" style=\"font-size:${this.fs(dl,13)}px\">${dl}</span></div>\n        <div class=\"row up\">${this.icon('upload',14)}<span class=\"val\" style=\"font-size:${this.fs(up,13)}px\">${up}</span></div>\n      </div>`;\n  }\n\n  render1x2() {\n    const d = this.data, c = this.colors, t = categorizeTorrents(this.torrents);\n    const dl = formatSpeed(d.dl_info_speed), up = formatSpeed(d.up_info_speed);\n    return html`<style>${this.baseStyle}.w{flex-direction:row;padding:8px 12px;align-items:center;justify-content:space-between}.left{display:flex;flex-direction:column;gap:6px}.row{display:flex;align-items:center;gap:4px}.val{font-weight:700}.right{display:flex;gap:12px}.stat{text-align:center}.stat-val{font-size:12px;font-weight:700;display:block}.stat-label{font-size:8px;color:${c.sub}}</style>\n      <div class=\"w\">\n        <div class=\"left\">\n          <div class=\"row dl\">${this.icon('download',12)}<span class=\"val\" style=\"font-size:${this.fs(dl,14)}px\">${dl}</span></div>\n          <div class=\"row up\">${this.icon('upload',12)}<span class=\"val\" style=\"font-size:${this.fs(up,14)}px\">${up}</span></div>\n        </div>\n        <div class=\"right\">\n          <div class=\"stat dl\"><span class=\"stat-val\">${t.downloading}</span><span class=\"stat-label\">ä¸‹è½½</span></div>\n          <div class=\"stat seed\"><span class=\"stat-val\">${t.seeding}</span><span class=\"stat-label\">åšç§</span></div>\n          <div class=\"stat total\"><span class=\"stat-val\">${t.total}</span><span class=\"stat-label\">æ€»æ•°</span></div>\n        </div>\n      </div>`;\n  }\n\n  render2x1() {\n    const d = this.data, c = this.colors, t = categorizeTorrents(this.torrents);\n    const dl = formatSpeed(d.dl_info_speed), up = formatSpeed(d.up_info_speed);\n    return html`<style>${this.baseStyle}\n      .w{padding:8px;justify-content:space-between}\n      .speed-card{background:${c.glass};border-radius:8px;padding:8px 6px;text-align:center}\n      .speed-icon{margin-bottom:4px;opacity:.9}\n      .speed-val{font-weight:800;display:block;line-height:1.2}\n      .stats{display:flex;justify-content:space-around;padding:0 4px}\n      .stat{text-align:center}\n      .stat-val{font-size:13px;font-weight:700;display:block}\n      .stat-label{font-size:8px;color:${c.sub}}\n    </style>\n      <div class=\"w\">\n        <div class=\"speed-card dl\">"
        }
      ]
    },
    {
      "id": "weather-app",
      "path": "weather-app",
      "componentsConfig": "weather-app/config/components.config.js",
      "widgets": [
        {
          "id": "weather-widget",
          "sizes": [
            "1x1",
            "1x2",
            "1xfull",
            "2x1",
            "2x2",
            "2x4"
          ],
          "componentPath": "weather-app/src/components/weather-widget.js",
          "baseStyle": "\n      :host { display: block; width: 100%; height: 100%; overflow: hidden; }\n      * { box-sizing: border-box; margin: 0; padding: 0; }\n      .w {\n        width: 100%; height: 100%;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        color: initial;\n        display: flex; flex-direction: column;\n        overflow: hidden;\n        min-height: 0;\n      }\n    ",
          "sizeStyles": {},
          "showArtSizes": null,
          "hideSubSizes": null,
          "hideDateSizes": null,
          "sourcePreview": "import { html } from 'lit';\nimport { SunPanelWidgetElement } from '@sun-panel/micro-app';\nimport { getWeatherIcon, getAqiColor, getAqiBgColor } from '../utils/weather-icons.js';\n\nexport class WeatherWidget extends SunPanelWidgetElement {\n  static properties = {\n    weather: { type: Object },\n    air: { type: Object },\n    hourly: { type: Array },\n    daily: { type: Array },\n    loading: { type: Boolean },\n    error: { type: String },\n    config: { type: Object }\n  };\n\n  constructor() {\n    super();\n    this.weather = null;\n    this.air = null;\n    this.hourly = [];\n    this.daily = [];\n    this.loading = true;\n    this.error = '';\n    this.config = {};\n    this._refreshTimer = null;\n  }\n\n  async onInitialized() {\n    await this.loadConfig();\n    await this.fetchWeather();\n    this.startAutoRefresh();\n  }\n\n  async onWidgetInfoChanged(newWidgetInfo, oldWidgetInfo) {\n    // æ— è®ºä»€ä¹ˆå˜åŒ–éƒ½è§¦å‘é‡ç»˜ï¼ˆåŒ…æ‹¬ç½‘æ ¼å°ºå¯¸å˜åŒ–ï¼‰\n    this.requestUpdate();\n\n    // æ£€æŸ¥é…ç½®æ˜¯å¦å˜åŒ–\n    const newConfig = newWidgetInfo?.config;\n    const oldConfig = oldWidgetInfo?.config;\n\n    // åªæœ‰é…ç½®å®é™…å˜åŒ–æ—¶æ‰é‡æ–°è·å–å¤©æ°”\n    if (newConfig && JSON.stringify(newConfig) !== JSON.stringify(oldConfig)) {\n      this.config = newConfig;\n      await this.fetchWeather();\n      // åˆ·æ–°é—´éš”å¯èƒ½å˜äº†ï¼Œé‡æ–°å¯åŠ¨è‡ªåŠ¨åˆ·æ–°\n      this.startAutoRefresh();\n    }\n  }\n\n  async loadConfig() {\n    this.config = this.spCtx.widgetInfo?.config || {};\n  }\n\n  startAutoRefresh() {\n    if (this._refreshTimer) clearInterval(this._refreshTimer);\n    const interval = (this.config?.refreshInterval || 15) * 60 * 1000;\n    this._refreshTimer = setInterval(() => this.fetchWeather(), interval);\n  }\n\n  onDisconnected() {\n    if (this._refreshTimer) {\n      clearInterval(this._refreshTimer);\n      this._refreshTimer = null;\n    }\n  }\n\n  async fetchWeather() {\n    this.loading = true;\n    this.error = '';\n\n    const createRequest = (endpoint) => ({\n      targetUrl: `https://{{host}}/v7/${endpoint}?location={{location}}&key={{apiKey}}`,\n      method: 'GET',\n      templateReplacements: [\n        { placeholder: '{{apiKey}}', fields: ['targetUrl'], dataNode: 'config.apiKey' },\n        { placeholder: '{{host}}', fields: ['targetUrl'], dataNode: 'config.apiHost' },\n        { placeholder: '{{location}}', fields: ['targetUrl'], dataNode: 'config.locationValue' }\n      ]\n    });\n\n    try {\n      // å…ˆè¯·æ±‚ä¸»å¤©æ°”ï¼Œé¿å… templateReplacements å¤±è´¥æ—¶å¹¶å‘æ”¾å¤§é”™è¯¯æ—¥å¿—\n      const nowRes = await this.spCtx.api.network.request(createRequest('weather/now'));\n      const [airRes, hourlyRes, dailyRes] = await Promise.all([\n        this.spCtx.api.network.request(createRequest('air/now')).catch(() => null),\n        this.spCtx.api.network.request(createRequest('weather/24h')),\n        this.spCtx.api.network.request(createRequest('weather/7d'))\n      ]);\n\n      const nowData = nowRes?.data || nowRes;\n      const airData = airRes?.data || airRes;\n      const hourlyData = hourlyRes?.data || hourlyRes;\n      const dailyData = dailyRes?.data || dailyRes;\n\n      if (nowData?.code === '200') {\n        this.weather = nowData.now;\n      } else {\n        const errorMessages = {\n          '400': 'è¯·æ±‚é”™è¯¯',\n          '401': 'API Key æ— æ•ˆ',\n          '402': 'è¶…è¿‡è®¿é—®æ¬¡æ•°é™åˆ¶',\n          '403': 'æ— è®¿é—®æƒé™',\n          '404': 'æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨',\n          '429': 'è¯·æ±‚è¿‡äºé¢‘ç¹',\n          '500': 'æœåŠ¡å™¨é”™è¯¯'\n        };\n        throw new Error(errorMessages[nowData?.code] || `APIé”™è¯¯: ${nowData?.code || 'æœªçŸ¥'}`);\n      }\n\n      if (airData?.code === '200') this.air = airData.now;\n      if (hourlyData?.code === '200') this.hourly = hourlyData.hourly || [];\n      if (dailyData?.code === '200') this.daily = dailyData.daily || [];\n\n    } catch (e) {\n      const msg = String(e?.message || '');\n      if (msg.includes('data node not found') || msg.includes('failed to get data node')) {\n        this.error = 'è¯·å…ˆåœ¨é…ç½®é¡µä¿å­˜ï¼ˆä¼šå†™å…¥åŠ å¯†å ä½æ‰€éœ€æ•°æ®ï¼‰';\n      } else {\n        this.error = e.message || 'è·å–å¤©æ°”å¤±è´¥';\n      }\n      console.error('Weather fetch error:', e);\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  onDarkModeChanged() {\n    this.requestUpdate();\n  }\n\n  get cityName() {\n    return this.config?.cityName || 'æœªçŸ¥';\n  }\n\n  get colors() {\n    const light = this.config?.textMode !== 'dark';\n    return {\n      text: light ? '#fff' : '#1a1a2e',\n      textSub: light ? 'rgba(255,255,255,0.75)' : 'rgba(0,0,0,0.6)',\n      glass: light ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.06)'\n    };\n  }\n\n  // åŸºç¡€æ ·å¼ - æ‰€æœ‰å°ºå¯¸ç»Ÿä¸€é˜²æº¢å‡º\n  get baseStyle() {\n    return `\n      :host { display: block; width: 100%; height: 100%; overflow: hidden; }\n      * { box-sizing: border-box; margin: 0; padding: 0; }\n      .w {\n        width: 100%; height: 100%;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        color: ${this.colors.text};\n        display: flex; flex-direction: column;\n        overflow: hidden;\n        min-height: 0;\n      }\n    `;\n  }\n\n  render() {\n    const c = this.colors;\n    if (!this.config || Object.keys(this.config).length === 0) {\n      return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;font-size:11px;color:${c.textSub}}</style><div class=\"w\">è¯·é…ç½® API Key</div>`;\n    }\n    if (this.loading) {\n      return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;font-size:11px;color:${c.textSub}}</style><div class=\"w\">åŠ è½½ä¸­...</div>`;\n    }\n    if (this.error) {\n      return html`<style>${this.baseStyle}.w{align-items:center;justify-content:center;font-size:11px;color:#f87171}</style><div class=\"w\">${this.error}</div>`;\n    }\n\n    const size = this.spCtx.widgetInfo?.gridSize;\n    switch (size) {\n      case '1x1': return this.render1x1();\n      case '1x2': return this.render1x2();\n      case '1xfull': return this.render1xfull();\n      case '2x1': return this.render2x1();\n      case '2x2': return this.render2x2();\n      case '2x4': return this.render2x4();"
        }
      ]
    }
  ]
}